<!DOCTYPE html>
<html>
  
 <head>
 
   <title>Are They Vegan Friendly?</title>

  <!-- Load Leaflet code library: see http://leafletjs.com/download.html -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.8.0/dist/leaflet.css" integrity="sha512-hoalWLoI8r4UszCkZ5kL8vayOGVae1oxXe/2A4AO6J9+580uKHDO3JdHb7NzwwzK5xr/Fs0W40kiNHxM9vyTtQ==" crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.8.0/dist/leaflet.js" integrity="sha512-BB3hKbKWOc9Ez/TAwyWxNXeoV9c1v6FIeYiBieIWkpLjauysF18NzgR1MBNBXf8/KABdlkX68nAhlwcDFLGPCQ==" crossorigin=""></script>
  
   <!-- load legend css -->
  <script src="legend.css"></script>

  
  <!-- Position the map and title with Cascading Style Sheet (CSS) -->  
  <style>
  
    body { margin:0; padding:0; }
    #map { position: absolute; top:0; bottom:0; right:0; left:0; }
    #map-title { position: relative; margin-top: 10px; margin-left: 25%; float: left; background: white; border: 2px solid rgba(0,0,0,0.2); padding: 6px 8px; font-family: Helvetica; font-weight: bold; font-size: 1.2rem; z-index: 800; }    
    
  </style>
   
  </head>
 
 <body>

    <!-- Display title with HTML division tags  -->
    <div id="map-title">Are They Vegan<br>Friendly?</div>
   
    <!-- display map -->
    <div id="map"></div>

    <!-- Create the interactive map content with JavaScript (.js) -->
  <script>
    
    // Initialize the map and set the view
    var map = L.map('map').setView([-33.8688, 151.2093], 13);

    var mapLayer = L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://osm.org/copyright">\
      OpenStreetMap</a> contributors, &copy;\
      <a href="https://carto.com/attribution">CARTO</a>'
    });
    
    mapLayer.addTo(map);

    // Gets user location and is used at the end of the document since it disrupts the rest of the markers
//     function getUserLocation() {
//     if (navigator.geolocation) {
//         navigator.geolocation.getCurrentPosition(function(position) {
//             var lat = position.coords.latitude;
//             var lon = position.coords.longitude;
//             var userLocation = L.marker([lat, lon]).addTo(map);
//             userLocation.bindPopup("You are here!");
//         });
//     } else {
//         console.log("Geolocation is not supported by this browser.");
//       }
//     }
    
    // custom Icons
    var GreenIcon = L.icon({
      iconUrl: 'data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0z" fill="rgb(86,113,90)"></path></svg>',
      iconSize: [30, 30],
      iconAnchor: [12.5, 41],
      popupAnchor: [0, -41]
     })

    var RedIcon = L.icon({
      iconUrl: 'data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0z" fill="rgb(214,50,50)"></path></svg>',
      iconSize: [30, 30],
      iconAnchor: [12.5, 41],
      popupAnchor: [0, -41]
     })


    var YellowIcon = L.icon({
      iconUrl: 'data:image/svg+xml;charset=UTF-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M172.268 501.67C26.97 291.031 0 269.413 0 192 0 85.961 85.961 0 192 0s192 85.961 192 192c0 77.413-26.97 99.031-172.268 309.67-9.535 13.774-29.93 13.773-39.464 0z" fill="rgb(241,194,50)"></path></svg>',
      iconSize: [30, 30],
      iconAnchor: [12.5, 41],
      popupAnchor: [0, -41]
     })

    
    // an array of coordinates for YES Chai Me
    var coordinatesChaiMe = [
      {lat: -33.882948709789, lng: 151.1914159115681, title: "Sapphos", Soy: "", Oat: "Alt Dairy Co", Almond: "", Date: "Nov 2022"},
      {lat: -33.887869824610696, lng: 151.21438351549025, title: "Bourke St Surry Hills", Soy: "Bonsoy", Oat: "Alt Dairy Co", Almond: "", Date: "Nov 2022"},
      {lat: -33.86435381387368, lng: 151.20142669807498, title: "Bourke St Barangaroo", Soy: "", Oat: "", Almond: "", Date: "Nov 2022"}
    ];

    //loop through coordinates and add markers
    for (var i = 0; i < coordinatesChaiMe.length; i++) {
        var markerChaiMe = new L.marker([coordinatesChaiMe[i].lat, coordinatesChaiMe[i].lng],{icon: YellowIcon}).addTo(map);
        marker.bindPopup(
          "<h3><b>" + coordinatesChaiMe[i].title + "</b></h3>" + "<b>Soy:</b> " + coordinatesChaiMe[i].Soy + "<br>" + "<b>Oat:</b> " + coordinatesChaiMe[i].Oat + "<br>" + "<b>Almond:</b> " + coordinatesChaiMe[i].Almond + "<br><br>" + "<b>Date last confirmed:</b> " + coordinatesChaiMe[i].Date);
    }

    // an array of coordinates for VEGAN Chai
    var coordinatesVeganChai = [
      {lat: -33.88226770573398, lng: 151.19015070768268, title: "Oh My Days", Soy: "", Oat: "", Almond: "", Date: "Nov 2022"},
      {lat: -33.88360595953672, lng: 151.19162860482174, title: "Lilypad Sydney", Soy: "", Oat: "", Almond: "", Date: "Nov 2022"},
      {lat: -33.868925740936255, lng: 151.20771357624943, title: "Romolo Pitt St", Soy: "", Oat: "", Almond: "", Date: "Nov 2022"}
    ];

    //loop through coordinates and add markers
    for (var i = 0; i < coordinatesVeganChai.length; i++) {
      var markerVeganChai = new L.marker([coordinatesVeganChai[i].lat, coordinatesVeganChai[i].lng], {icon: GreenIcon}).addTo(map);
        marker.bindPopup(
          "<h3><b>" + coordinatesVeganChai[i].title + "</b></h3>" + "<b>Soy:</b> " + coordinatesVeganChai[i].Soy + "<br>" + "<b>Oat:</b> " + coordinatesVeganChai[i].Oat + "<br>" + "<b>Almond:</b> " + coordinatesVeganChai[i].Almond + "<br><br>" + "<b>Date last confirmed:</b> " + coordinatesVeganChai[i].Date);
    }

    var coordinatesNotEthical = [

      {lat: -32.88226770573398, lng: 151.19015070768268, title: "Oh My Days", Soy: "", Oat: "", Almond: "", Date: "Nov 2022"},
      
      ];

    //loop through coordinates and add markers
    for (var i = 0; i < coordinatesNotEthical.length; i++) {
      var markerNotEthical = new L.marker([coordinatesNotEthical[i].lat, coordinatesNotEthical[i].lng], {icon: RedIcon}).addTo(map);
        marker.bindPopup(
          "<h3><b>" + coordinatesNotEthical[i].title + "</b></h3>" + "<b>Soy:</b> " + coordinatesNotEthical[i].Soy + "<br>" + "<b>Oat:</b> " + coordinatesNotEthical[i].Oat + "<br>" + "<b>Almond:</b> " + coordinatesNotEthical[i].Almond + "<br><br>" + "<b>Date last confirmed:</b> " + coordinatesNotEthical[i].Date);
    }
    
    // Makes a layer control feature
      // creates a base layer object
      
      //Layer groups to add
      var markerChaiMeGroup = L.layerGroup(markerChaiMe);
      var markerVeganGroup = L.layerGroup(markerVeganChai);
      var markerNotEthicalGroup = L.layerGroup(markerNotEthical);

      
      var baseLayers = {
        "Map" = mapLayer
      }
      
      // creates an overlay object
      
      var overlays = {
        "Chai Me" = markerChaiMeGroup,
        "Vegan" = markerVeganGroup,
        "Not Friendly" = markerNotEthicalGroup
      }

    // Makes a marker for user location
    var marker = new L.marker(getUserLocation()).addTo(map);

  </script>
 </body>
</html>
